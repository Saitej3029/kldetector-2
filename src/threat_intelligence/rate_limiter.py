# Rate Limiter for API Requests in Windows EDR\n\nimport time\nfrom threading import Lock\n\nclass RateLimiter:\n    def __init__(self, rate_limit):\n        self.rate_limit = rate_limit  # max calls per time frame\n        self.lock = Lock()  # to control access to the rate limit\n        self.calls = 0  # number of calls made\n        self.start_time = time.time()  # time of the first call\n\n    def wait(self):\n        with self.lock:\n            elapsed = time.time() - self.start_time\n            if elapsed < 1:  # assuming rate limit is per second\n                if self.calls >= self.rate_limit:\n                    time_to_wait = 1 - elapsed  # time to wait until limit resets\n                    time.sleep(time_to_wait)\n                    self.calls = 0  # reset calls after waiting\n                    self.start_time = time.time()  # reset the timer\n            self.calls += 1  # increment call count\n\n# Example usage\nif __name__ == '__main__':\n    rate_limiter = RateLimiter(rate_limit=5)  # allows 5 calls per second\n    for i in range(10):\n        rate_limiter.wait()  # enforce rate limit\n        print(f"API call {i + 1}")  # replace with actual API call\n